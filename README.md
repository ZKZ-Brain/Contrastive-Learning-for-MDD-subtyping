# Contrastive-Learning-for-MDD-subtyping
This repository provides code for the paper "Contrastive learning enhances the links between functional signatures and antidepressant treatment"

* [a_raw_data/](a_raw_data/)
Raw data of the REST-meta-MDD II (train set), REST-meta-MDD I (test set) and Stanford Accelerated Intelligent Neuromodulation Therapy (rTMS set)
,the train set is available at [http://rfmri.org/REST-meta-MDD](http://rfmri.org/REST-meta-MDD), while the test set and rTMS set are available from the corresponding author upon reasonable request.
  * [REST-meta-MDD2_sample.xlsx](a_raw_data/sample_files/REST-meta-MDD2_sample.xlsx). 10 samples message of the test set
  * [fALFF_IS001-1-0001.nii.gz](a_raw_data/sample_files/fALFF_IS001-1-0001.nii.gz)-[fALFF_IS001-1-0025.nii.gz](a_raw_data/sample_files/fALFF_IS001-1-0025.nii.gz). 25 samples of data from the train set

* [b_data/](b_data/)
 Statistical tables and Generated data
  * [table_of_3_datasets](b_data/table_of_3_datasets.zip). Statistical table of three datasets, password will be provided upon agreement from the corresponding author.
  * [S3000.zip](b_data/S3000.zip), [S2380_test.zip](b_data/S2380_test.zip). Split compressed .npz files corrosponding to raw nii files generated by '[a_format_conversion.py](source/a_format_conversion.py)'.
  * [S26_rTMS.npz](b_data/S26_rTMS.npz).  .npz files corrosponding to raw nii files generated by '[a_format_conversion.py](source/a_format_conversion.py)'.
 
* [c_torch_weight/](c_torch_weight/)
Saved weights for created CVAE models, generated by '[d_train_CVAE](source/d_train_CVAE.py)'
  * '[model_best_train.pth](c_torch_weight/model_best_train.pth)'. weights trained by trainset data
  * '[model_best_test.pth](c_torch_weight/model_best_test.pth)'. weights trained by testset data
 
* [d_results_of_z/](d_results_of_z/)
Save latent features of input data, extracted by '[e_extract_latent_feature](source/e_extract_latent_feature.py)'
  * [latent_z_train](d_results_of_z/latent_z_train.npz), [latent_z_test](d_results_of_z/latent_z_test.npz), [latent_z_rTMS](d_results_of_z/latent_z_rTMS.npz).  latent z for the trainset, testset and rTMS set respectively, dimension=32
  * [latent_z_train512](d_results_of_z/latent_z_train512.zip), [latent_z_rTMS512](d_results_of_z/latent_z_rTMS512.npz). latent z for the trainset and rTMS set respectively,  dimension=512





* [requirments.txt](requirements.txt) A list of the required environment and python packages.

